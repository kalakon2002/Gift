<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Footstep 1 Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: 'Creepster', cursive;
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  background: url('halloweenmusic.png') no-repeat center center fixed;
  background-size: cover;
}

.title {
  margin-top: 20px;
  font-size: 48px;
  color: gold;
  text-shadow: 0 0 5px #660000, 0 0 10px #440000, 0 0 15px #220000;
  text-align: center;
}

.image-container {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}

img {
  max-width: 80%;
  max-height: 80%;
  border: 5px solid gold;
  border-radius: 10px;
}

.bottom-panel {
  width: 100%;
  padding: 20px 0;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.options {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin-bottom: 15px;
}

.option {
  width: 50px;
  height: 50px;
  background: rgba(105,105,105,0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: 5px;
  font-weight: bold;
  color: black;
  user-select: none;
  transition: transform 0.1s, background 0.2s;
}

.option:hover { transform: scale(1.1); }
.option.selected { background: #222222; color: white; }

button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 10px;
  border-radius: 8px;
  border: none;
  background: #b30000;
  color: white;
}

.overlay-message {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  font-size: 32px;
  font-weight: bold;
  text-align: center;
  color: white;
  z-index: 999;
}
</style>
</head>
<body>

<!-- Halloween Intro Overlay -->
<div id="halloweenIntro" style="
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.95);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color: #ffcc00;
  font-family: 'Creepster', cursive;
  font-size: 2em;
  text-align:center;
  z-index:1000;
">
  <p>So, the first step is to find how many notes don't need any pedals?</p>
  <p>Give me your lights, your majesty.</p>
  <button id="startQuizBtn" style="
    margin-top:30px;
    padding: 15px 25px;
    font-size:1.2em;
    border:none;
    border-radius:10px;
    background:#b30000;
    color:white;
    cursor:pointer;
  ">Let me answer</button>
</div>

<audio id="bgMusic" src="music.mp3" loop autoplay></audio>

<div class="title">Footstep 1</div>

<div class="image-container">
  <img id="sheet" src="musicsheet.png" alt="Music Sheet">
</div>

<div class="bottom-panel">
  <div class="options" id="options">
    <div class="option">1</div>
    <div class="option">2</div>
    <div class="option">3</div>
    <div class="option">4</div>
    <div class="option">5</div>
    <div class="option">6</div>
    <div class="option">7</div>
    <div class="option">8</div>
    <div class="option">9</div>
    <div class="option">10</div>
    <div class="option">11</div>
    <div class="option">12</div>
    <div class="option">13</div>
    <div class="option">14</div>
  </div>
  <button id="next">Submit</button>
</div>

<div class="overlay-message" id="overlayMessage">
  <div id="messageText"></div>
  <button id="goBackBtn" style="display:none;">Go Back</button>
</div>

<script>
const options = document.querySelectorAll('.option');
const nextBtn = document.getElementById('next');
const overlayMessage = document.getElementById('overlayMessage');
const messageText = document.getElementById('messageText');
const goBackBtn = document.getElementById('goBackBtn');
const bgMusic = document.getElementById('bgMusic');

let selected = null;
const correctAnswer = 9;
const puzzleNum = 1;

// Keep music playing
if (!localStorage.getItem('musicPlaying')) {
  bgMusic.play().catch(e => console.log('Autoplay blocked:', e));
  localStorage.setItem('musicPlaying', 'true');
}

// Halloween intro overlay
const startQuizBtn = document.getElementById('startQuizBtn');
const halloweenIntro = document.getElementById('halloweenIntro');

startQuizBtn.addEventListener('click', () => {
  halloweenIntro.style.display = 'none';
});

// Select option
options.forEach(option => {
  option.addEventListener('click', () => {
    options.forEach(o => o.classList.remove('selected'));
    option.classList.add('selected');
    selected = parseInt(option.textContent);
  });
});

// Submit answer
nextBtn.addEventListener('click', () => {
  if (selected === null) return;
  overlayMessage.style.display = 'flex';
  goBackBtn.style.display = 'block';

  if (selected === correctAnswer) {
    overlayMessage.style.backgroundColor = 'green';
    messageText.textContent = 'Good jobbb girll, take a keyy!';
  } else {
    overlayMessage.style.backgroundColor = 'red';
    messageText.textContent = 'Shame on you, you are trying to be a musician. You are terrible.';
  }
});

// Handle "Go Back"
goBackBtn.addEventListener('click', () => {
  if (selected === correctAnswer) {
    let completed = JSON.parse(localStorage.getItem('completedPuzzles')) || [];
    if (!completed.includes(puzzleNum)) {
      completed.push(puzzleNum);
      localStorage.setItem('completedPuzzles', JSON.stringify(completed));

      let keys = parseInt(localStorage.getItem('keys')) || 0;
      keys++;
      if (keys > 5) keys = 5;
      localStorage.setItem('keys', keys);
    }
  }
  window.location.href = 'MapPage.html';
});
</script>

</body>
</html>
